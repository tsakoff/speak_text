# 運転中でも試験勉強できる！？gTTSを使って音声ファイルを作ってみました。
## 概要
移動中に自分がまとめた学習内容を聞き流せるように、
gTTSを使ってテキストファイルを音声ファイルに変換してみました。

## Introduction
まず、私は社会人でもありますが、大学生でもあります。
そんな大学生から切っても切り離せないものが「試験」ですよね。
試験前には大体の方が勉強したかと思います。
試験当日なんかはギリギリまで参考書を見たりしていた方も多いのではないでしょうか。

私も多くの方と同様にギリギリまで眺める派なのですが、
最近電車に乗るのが億劫すぎて、、車移動を中心にしています。
そのため、「見る」学習は移動時間にすることが難しいのですよね。（間違いなく事故る）

どうにかならんかなー、と~~現実逃避~~考えてたら
「車の中で聞き流せるようにすればいいじゃないか」
とふと思いつき、さっと調べると今回のネタである「gTTS」なるものを見つけた次第です。

## 作ってみよう
### 動かした環境
- Ubuntu 20.04.4 LTS
- Python 3.8.7
- gtts 2.3.0

gTTSは以下のコマンドでインストールできます。
`pip install gTTS`

ん？pipがない？ Google Is Your Friend！

### step 0
簡易的なテキストであれば、コマンドラインで`gtts-cli`を実行するとあっという間に音声ファイルが出来上がります。

`gtts-cli 'ドレミファソラシド' --output DoRemi.mp3`
`gtts-cli 'ドレミファソラシド' -l ja --output ドレミ_ja.mp3`

デフォルトはenなので、DoRemi.mp3は英語っぽく、ドレミ_ja.mp3は日本語のアクセントでしゃべってくれます。

TODO: 作ったどれみファイルをここに置く。

### step 1
step0の内容は自分が求めている内容ではないので、プログラムを書こうと思います。
まずは基本的な使い方を学ぶために簡単なコードを書いてみます。

speak.py
```
from gtts import gTTS
tts = gTTS('ドレミファソラシド', lang='ja')
tts.save('ドレミ_ja.mp3')
```
step0の内容をコードにしたものです。
`gTTS`でテキストファイルを指定した言語で音声変換し、`save()`でファイルに保存します。
使い方がとっても簡単・・・

### step2
固定のテキストではなく、別ファイルからテキストを読み込ませたいのでプログラムを追記していこうと思います。

```
from gtts import gTTS

f = open('Sample.md', 'r')
tts = gTTS(f.read(), lang='ja')
tts.save('Sample.mp3')
f.close()
```
同じディレクトリにある、`Sample.md`を読み込んで音声ファイルを作ります。
マークダウンファイルは好きにカスタマイズすればいいと思います。

### step3
読み込みたいファイルは一つではないので、一括で読み込んで変換するプログラムにしようと思います。
```
from gtts import gTTS
import re
import glob

files = glob.glob("*.md")
for file in files:
  f = open(file, 'r')
  lines = f.readlines()
  # 先頭の見出し文字を削除
  text = "".join(map(lambda x: re.sub('^#+ ', '', x), lines))
  tts = gTTS(text, lang='ja')
  tts.save('sounds/' + file.split('.')[0] + '.mp3')
  f.close()
```





### いざ学習
出来上がった音声ファイルは、車で再生できるデバイスに入れてあげましょう。
私はSDカードにコピーして再生してました。（人のぬくもりが感じられる作業ですね）
再生モードはランダムにして、ハンドルについてるオーディオ操作ボタンで進めたり戻したりしてました。

## 感想
- Python初心者の自分にも簡単に使えた
  - コマンドライン叩くだけならそもそもPythonの知識要らん。
- 思った以上にちゃんと読んでくれる。
  - 漢字の読み間違えとかもうちょっと多くなるのかと思っていた。
  - 「てにおは」はあやしい。
- `-`は無視してくれるみたい。読めないだけ？
- ！マークを重ねると「感嘆符」とかしゃべりだす。

## 最後に
あくまで運転中は運転に集中しましょう。

電車で行けばいいのでは、というのも一つの案なのですけど、
SNSやってる時間が大半になりそうなんだよなぁ。
なので、しばらく聞き流し作戦を使おうと思います。

結構簡単に作れるので、聞き流しファイルを作りたい方は
是非トライしてみてくださいー。

[my GitHub Repository](https://github.com/tsakoff/speak_text)

## 参考文献
- [GitHub: gTTS](https://github.com/pndurette/gTTS)
- [gTTS Documentation](https://gtts.readthedocs.io/en/latest/index.html)


